{% extends "index.html" %}

{%block principal %}

<!--	<script src = "assets\js\listaSequencial.js"></script> o que importa o código em Javascript da lista sequencial -->
<main class="text-center bg_secundario">
	<h3 class="tx_primario">Lista Sequencial</h3>


	<div id="content" class="col-12">
		<div class="row">
			<div id="detalhes" class="col-lg-2 col-sm-12 border"><hr>

				<div id="obs">
				
						
						<p>Dica:  Antes de começar defina o tamanho da sua lista :</p>
					<!--	<label for="#tamanho">Definir o tamanho da lista : </label> -->
						<div class = "row">

					<div class="col-6 nopadding">
							<input id="funfa" class="col-11 padding-top 50px padding-bottom 50px text-center" type="text" name="funfa" title="Entrada para definir o tamanho da lista " placeholder="Tamanho">
						</div>	
					<div class="col-6 nopadding">
							<button type="button" class=" col-7.8  btn btn-info btn-sm" id ="btntam">Confirmar</button>
						</div>
					</div>
				</div><hr>
		
				<div id="atributos">
					<h5>Detalhes</h5>
					<label for="#nelementos">Nº de elementos: </label>
					<span id="nelementos" class="badge badge-light"> 0 </span><br>
					<label for="#tamanho">Tamanho: </label>
					<span id="tamanho" class="badge badge-light"> 0 </span><br>
				</div><hr>

				<div id="interacao" class="col-12">
					<h5>Interagir</h5>
					<div class="row">


						<div class="col-6">
							<div id = "entrada" class="caixa" title="Informe o valor da caixa">
								<input type="text" id = "valor" name = "valor" placeholder="valor">
							</div>
						</div>

						<div class="col-6">
							<label>Entradas: </label>
							<input class="col-12 nopadding text-center" type="text" id = "posicao" name="posicao" title="Entradas em branco adiciona/remove ao fim da lista" placeholder="Posição">
						</div>

					</div>
					<div class="row">
						<div class="col-6 nopadding">
							<button type="button" class="btn btn-info btn-sm" id="btnadd">Adicionar</button>
						</div>
						<div class="col-6 nopadding">
							<button type="button" class="btn btn-danger btn-sm" id="btnrmv">Remover</button>
						</div>
					</div>Buscar na lista por:
					<div class="row">
						<div class="col-6 nopadding">
							<button type="button" class="btn btn-success btn-sm" id="btnpos">Posição</button>
						</div>
						<div class="col-6 nopadding">
							<button type="button" class="btn btn-success btn-sm" id="btnval">Valor</button>
						</div>
					</div>
				</div><hr>
			</div>

			<div id="animacao" class="col-lg-10 col-sm-12 border">
				<div class="col-12 nopadding">
					<div class="comeco2"></div>
				</div>
				<div id="apresentacao" class="col-12 nopadding"></div>
			</div>


		<!--	<div id="apresentacao" class="col-lg-10 col-sm-12 border">
				<div id = "start"  class = "comeco2"></div>

		</div> -->


	</div>
</main>


<!-- Código em java Script que será transferido depois para um arquivo separado.-->


<script type="text/javascript">

	// cria uma lista	
	var ListaSeq = function(tamanho){
		this.tamanho = tamanho;
		this.nElementos = 0;
		this.dados = new Array();
	}

	// verifica se lista está cheia
	ListaSeq.prototype.cheia = function(tamanho){
		return this.nElementos == this.tamanho;
	}



	$(document).ready(function() {

		function ligaBTN(){ // abilita botões
			$('#btnadd').prop('disabled',false);
			$('#btnrmv').prop('disabled',false);
			$('#btnval').prop('disabled', false);
	        $('#btnpos').prop('disabled', false);	
		}

		function desligaBTN(){ // desabilita botões
			$('#btnadd').prop('disabled',true);
			$('#btnrmv').prop('disabled',true);
			$('#btnval').prop('disabled', true);
	        $('#btnpos').prop('disabled', true);
		}

		//funçoes que atualizam mo campo de Detalhes
		function atualizaTamanho(tamanho){ 
			$('#tamanho').html(" "+tamanho+" "); 

		}
		function atualizaElementos(nElementos){ 
			$('#nelementos').html(" "+nElementos+" ");

		}

		ligaBTN();
		var divID = 0; //para  a posição do elementos (não foi utilizado)
		var elementos = 0;

		// função do botão tamanho
		$('#btntam').click(function(){
			
			var tamanho = $('#funfa').val();
			if((/^\d+$/.test(tamanho))){ // verifica se tamanho é nº inteiros
				if(tamanho<101 && tamanho!=0){ //restrição de valores para o tamanho da lista (não deixar o usuário criar lista pequenas ou enormes) (*)
					lista = new ListaSeq(tamanho); //cria uma lista
					atualizaTamanho(tamanho);
					for (var i = 0; i < tamanho; i++) {
						$('#apresentacao').append('<div id="caixa'+divID+'" class="caixautil animate float-left" style="position: static;"><div class="caixa float-left"><input type="text" value="0" disabled></div></div>'); //cria uma nova caixa para a simulação
					}
					ligaBTN();
					$('#btntam').prop('disabled', true); // desliga o botão para que o usuário não tente colocar mais valores no tamanho
				}
				else{
					alert("Lista muito grande ou muito pequena.\n"); //(*)
				}
			}
			else{
				alert("Digite um número inteiro.\n");
			}
		}); // acaba aqui a do botão tamanho


		//função do botão adicionar 
		$('#btnadd').click(function(){
			// verifica se valor e posição são nº inteiros
			if(/^\d+$/.test($('#valor').val())){  
				if(/^\d+$/.test($('#posicao').val())){ 
					var  pos = $('#posicao').val();
					// condições para NÃO inserção na caixinha
					if( parseInt(tamanho.innerText) == elementos || pos >parseInt(tamanho.innerText)+1 || pos<=0 || (pos - 1) > elementos ){ 
						alert("Número não pode ser adicionado!");
					}

					//adiciona o valor na caixinha na posição indicada(insere uma nova caixinha) e remove a última caixinha; 
					else{
						$(".caixautil").eq(pos - 1).before('<div id="caixa" class="caixautil animate float-left" style="position: static;"><div class="caixa float-left"><input type="text" value="'+$('#valor').val()+'" disabled></div></div>');
						$(".caixautil").last().remove(); 
						elementos++;
						atualizaElementos(elementos);
					}
				}
				else{
					alert("Digite uma posição válida!");	
				}
			}
			else{
					alert("Digite um número inteiro!");
				}
			$('#btnadd').prop('disabled',false);  // liga botão
			$('#btnrmv').prop('disabled',false);

		}); 

		
		//função da remover
		$('#btnrmv').click(function(){

			if(/^\d+$/.test($('#posicao').val())){ 
				var  pos = $('#posicao').val();
				if((pos-1) < 0 ||  (pos-1) >= elementos){ 
					alert("Posição inválida. Escolha outra!");
				}
				else{
				//console.log("posição: "+(pos-1)+ "  "+ $(".caixautil").length);
				// remove uma caixinha a partir da posição ; adiciona no fim uma nova caixinha
				$(".caixautil").eq(pos - 1).remove();
				$('#apresentacao').append('<div id="caixa'+divID+'" class="caixautil animate float-left" style="position: static;"><div class="caixa float-left"><input type="text" value="0" disabled></div></div>');
				elementos--;
				atualizaElementos(elementos);
			}

			}
			else{
				alert("Digite um número inteiro!");
			}
		}); 


		//busca por posição
		$('#btnpos').click(function(){
			desligaBTN(); // desabilita botões(usuário)

			if(/^\d+$/.test($('#posicao').val())){ 
				var  pos = $('#posicao').val();
				if((pos-1) < 0 ||  (pos-1) >= elementos){
					alert("Posição inválida!");
				}
				else{
						//animação - destaque na caixinha
					$('.animate').css({"opacity": 0.3});
              		$(".caixautil").eq(pos - 1).addClass("shadow border-2 rounded");
               		$(".caixautil").eq(pos - 1).animate({opacity: 1}, 1500);
				}

			}
			else{
				alert("Digite um número inteiro");
			}
		});


		
		//busca por valor
		$('#btnval').click(function(){
			desligaBTN();

			var achou = false; //registra se número foi encontrado ou não
			if(/^\d+$/.test($('#valor').val())){ 
				var  valor = $('#valor').val();
				var qtde  = $(".caixautil").length;

				for(var i = 0; i<elementos; i++){
				
						if(valor == ($('.caixautil > div > input').eq(i).val() ) ){ // verifica se o valor é igual ao valor da caixinha
							$('.animate').css({"opacity": 0.3});
	              			$(".caixautil").eq(i).addClass("shadow border-2 rounded");
	               			$(".caixautil").eq(i).animate({opacity: 1}, 1500);
	               			achou = true; //registrado
							break;
						}
				} 
				if(achou == false){
					alert("Número não encontrado na lista.");
				}
			} 
			else{
				alert("Digite um número inteiro.");
			}
		}); 

		// encerra a animação de busca por posição e por valor	
		$('#posicao').focus(function(){
	        $('.caixautil').removeClass("shadow border-2 rounded");
	        $('.animate').css({"opacity": 1});
	        ligaBTN();
	    });

	    $('#valor').focus(function(){
	        $('.caixautil').removeClass("shadow border-2 rounded");
	        $('.animate').css({"opacity": 1});
	        ligaBTN();
	    });

	}); // acaba aqui a do documento

</script>


{% endblock %}